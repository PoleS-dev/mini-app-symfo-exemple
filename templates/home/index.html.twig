{% extends 'base.html.twig' %}

{% block metaDescription %}

	<meta name="description" content="page home">
{% endblock %}

{% block stylesheets %}
	{# ‚Üê Important pour ne pas supprimer les styles existants #}
	{{ parent() }}

	{# Ici, {{ parent() }} ins√®re le contenu du bloc du base.html.twig, puis tu ajoutes ta propre feuille de style. #}
	<link rel="stylesheet" href="{{ asset('styles/home.css') }}">
	<link
	rel="stylesheet" href="{{ asset('styles/vendor/splide.min.css') }}">
{# <link rel="stylesheet" href="assets/styles/home.css">/ #}
{% endblock %}

{# {{ asset('...') }} est une fonction Twig tr√®s utilis√©e dans Symfony. Elle sert √† g√©n√©rer le chemin complet vers un fichier situ√© dans le dossier public/, qui est la racine "visible" de ton site web. #}

{% block title %}
	home
{% endblock %}


{% block body %}
	{% if app.user and is_granted('ROLE_ADMIN') %}

		<P>TU ES ADMIN
		</P>
	{% endif %}


	<div id="produit-carousel" data-controller="@splidejs/splide" class="splide mb-10">
		<div class="splide__track">
			<ul class="splide__list">
				{% for produit in produits %}
					<li class="splide__slide text-center">
						{% if produit.img %}
							<img src="{{ asset('images/product_image/' ~ produit.img) }}" alt="{{ produit.nom }}" class="w-64 h-48 object-cover mx-auto">
						{% else %}
							<img src="{{ asset('images/default_image.jpg') }}" alt="Aucune image" class="w-64 h-48 object-cover mx-auto">
						{% endif %}

						<div class="mt-2">
							<h5>{{ produit.nom }}</h5>
							<p>{{ produit.prix }}
								‚Ç¨</p>
						</div>
					</li>
				{% endfor %}
			</ul>
		</div>
	</div>


	{% if app.user %}


		<h2 class="text-2xl ">
			Bonjour
			{{ app.user.username}}
		</h2>


		{# <p>{{ dump(session.get('security_main')) }} </p>
				<p>{{ dump(session.all) }} </p> #}
		{{ app.request.query.get('page') }}

		<p>{{ app.request.query.get('page') }}
		</p>

	{% endif %}

	{% for type, messages in app.flashes %}
		{% for message in messages %}
			<div class="alert alert-{{ type }} alert-dismissible flash-message fade show" role="alert">
				{{ message }}
				<button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
			</div>
		{% endfor %}
	{% endfor %}

	<main class="flex flex-wrap gap-20 justify-center items-center">


		{% for produit in produits %}

			<div class="border w-64 p-10 justify-center items-center bg-orange-200 m-10 ">

				{% if produit.img %}

					<img class="w-full object-cover" src="{{ asset('images/product_image/' ~ produit.img) }}" alt="Image de {{ produit.nom }}">

				{% else %}
					pas image

				{% endif %}


				<p>
					<strong>Nom :</strong>
					{{ produit.nom }}</p>
				<p>
					<strong>Prix :</strong>
					{{ produit.prix }}
					‚Ç¨</p>
				<p>
					<strong>Description :</strong>
					{{ produit.description }}</p>
				<p>
					<strong>Cat√©gorie :</strong>
					{{ produit.category.name }}</p>
				{% if produit.stock < 3 and produit.stock > 0 %}

					<p>
						<strong class="text-red-500">achetez vite bientot en rupture !!! :</strong>
						stock :
						{{ produit.stock }}</p>
				{% elseif produit.stock >3 %}


					<p>
						<strong class="">stock</strong>
						{{ produit.stock }}</p>

				{% else %}
					<p>
						<strong class="text-red-500">
							victime de son succ√®s :</strong>
						stock : 0</p>

				{% endif %}


				<form action="{{ path('panier_ajouter', { id: produit.id }) }}" method="get" class="mt-3">
					<label for="quantite_{{ produit.id }}">Quantit√© :</label>
					<input type="number" id="quantite_{{ produit.id }}" name="quantite" value="0" min="1" max="{{ produit.stock }}" class="w-16 border p-1">
					<button type="submit" class="bg-green-600 text-white px-3 py-1 rounded hover:bg-green-700">
						üõí Ajouter au panier
					</button>
				</form>
			</div>
		{% endfor %}


	</main>

{% endblock %}

{% block js %}

	<script defer type="module" src=" {{ asset('script/home.js') }}"></script>

{% endblock %}
